---
title: "[Swift] [Combine] throttle() ã§ä¸€å®šæœŸé–“å‡ºåŠ›ã‚’ç„¡è¦–ã™ã‚‹"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Swift", "Combine"]
published: true
---

# `throttle(for:scheduler:latest:)`

Combine ã«ã¯ [`throttle(for:scheduler:latest:)`](https://developer.apple.com/documentation/combine/fail/throttle(for:scheduler:latest:)) ã¨ã„ã†ä¸€å®šæœŸé–“ã®å‡ºåŠ›ã‚’ç„¡è¦–ã—ã¦ãã‚Œã‚‹é–¢æ•°ãŒç”¨æ„ã•ã‚Œã¦ã„ãŸã®ã§ã€ãã‚Œã‚’ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

ã‚¹ãƒ­ãƒƒãƒˆãƒ«ã¯ã‚‚ã¨ã‚‚ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã‚‰ã—ã„ã®ã§ã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã´ã£ãŸã‚Šã§ã™ã­ã€‚

> ã‚¹ãƒ­ãƒƒãƒˆãƒ«ã¯ã€ã‚¬ã‚½ãƒªãƒ³ã‚¨ãƒ³ã‚¸ãƒ³ãªã©ã®äºˆæ··åˆç‡ƒç„¼æ©Ÿé–¢ã§ã¯ã€ã‚¨ãƒ³ã‚¸ãƒ³ã¸ã®å¸æ°—ï¼ˆç©ºæ°—ã‚ã‚‹ã„ã¯æ··åˆæ°—ï¼‰ã®æµå…¥é‡ã‚’èª¿æ•´ã—ã€ã‚¨ãƒ³ã‚¸ãƒ³ã®å‡ºåŠ›ã‚’èª¿ç¯€ã™ã‚‹å¼ã§ã‚ã‚‹ã€‚

[å‡ºå…¸: ãƒ•ãƒªãƒ¼ç™¾ç§‘äº‹å…¸ã€ã‚¦ã‚£ã‚­ãƒšãƒ‡ã‚£ã‚¢ï¼ˆWikipediaï¼‰ã€ã‚¹ãƒ­ãƒƒãƒˆãƒ«](https://ja.wikipedia.org/wiki/%E3%82%B9%E3%83%AD%E3%83%83%E3%83%88%E3%83%AB)


## ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

æŒ™å‹•ã¯ä»¥ä¸‹ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãŸã ãã®ãŒæ—©ã„ã¨æ€ã„ã¾ã™ã€‚

ã¾ãšã¯ä»¥ä¸‹ã®ã‚ˆã†ãªä¸€å®šé–“éš”ã§å‡ºåŠ›ã—ã¦ãã‚Œã‚‹ Publisher ã‚’ç”¨æ„ã—ã¾ã™ã€‚

```swift
import Combine
import Foundation

var cancellables = Set<AnyCancellable>()
let timerPublisher = Timer.publish(every: 2, on: .main, in: .default)
    .autoconnect()
    .share()
```

é©å½“ã« subscribe ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ã«ãªã‚Šã¾ã™ã€‚

```swift
timerPublisher
    .sink {
        print("output: \($0)")
    }
    .store(in: &cancellables)

//output: 2022-02-05 11:44:08 +0000
//output: 2022-02-05 11:44:10 +0000
//output: 2022-02-05 11:44:12 +0000
```

ã“ã“ã« [`throttle(for:scheduler:latest:)`](https://developer.apple.com/documentation/combine/fail/throttle(for:scheduler:latest:)) ã‚’é–“ã«å™›ã¾ã›ã¦ã„ãã¾ã™ã€‚

```swift
timerPublisher
    .throttle(for: .seconds(5), scheduler: DispatchQueue.main, latest: true)
    .sink {
        print("output: \($0)")
    }
    .store(in: &cancellables)

// output: 2022-02-05 12:15:18 +0000
// output: 2022-02-05 12:15:22 +0000
// output: 2022-02-05 12:15:28 +0000
```

å‡ºåŠ›ã‹ã‚‰ã¯åˆ†ã‹ã‚Šã«ãã„ã®ã§ã™ãŒã€å‡ºåŠ›ãŒ 5 ç§’é–“éš”ã«ãªã£ã¦ã€æµé‡ãŒã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

ä½¿ã„æ‰€ã¨ã—ã¦ã¯ã€ãƒœã‚¿ãƒ³ã®é€£æ‰“ãªã©ã€ã‚ã¾ã‚Šé€£ç¶šã§å‡¦ç†ã•ã›ãŸããªã„ã¨ã“ã‚ã§ä½¿ã£ã¦ã‚ã’ã‚‹ã¨ã‚ˆã•ãã†ã§ã™ã€‚

ä»¥ä¸Šã«ãªã‚Šã¾ã™ã€‚