---
title: "npm-scripts ã® é †æ¬¡ãƒ»ä¸¦åˆ—å®Ÿè¡Œï¼ˆnpm-run-allï¼‰"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["npm"]
published: true


---
# npm-run-all

> å…¬å¼ [npm-run-all](https://www.npmjs.com/package/npm-run-all)

npm-run-all ã¯è¤‡æ•°ã® npm-scripts ã‚’å®Ÿè¡Œã§ãã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã“ã¨ã§å¼•æ•°ã® npm-scripts ã®é †æ¬¡å®Ÿè¡Œ ã¾ãŸã¯ ä¸¦åˆ—å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

# å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

- é †æ¬¡å®Ÿè¡Œ
  - `npm-run-all --serial <task>` = `npm-run-all -s <task>` = `run-s <task>`
- ä¸¦åˆ—å®Ÿè¡Œ
  - `npm-run-all --parallel <task>` = `npm-run-all -p <task>` = `run-p <task>`

# å®Ÿéš›ã«ã‚„ã£ã¦ã¿ãŸ

## npm-scripts ã®æº–å‚™

```shell
# ä»¥ä¸‹ã®ã‚ˆã†ãª hello:foo ã¨ hello:bar ã¨ã„ã† npm-scripts ã‚’è¿½åŠ 
# ï¼ˆã¡ãªã¿ã« && ã¯å·¦ã®å‡¦ç†ãŒæˆåŠŸã—ãŸã‚‰å³ã®å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã„ã†ã‚‚ã®ï¼‰
$ vi package.json
{
  (çœç•¥)
  "scripts": {
+   "hello:foo": "sleep 1 && echo FOO",
+   "hello:bar": "sleep 1 && echo BAR"
  },
  (çœç•¥)
}

# 1ç§’å¾Œã« "FOO" ã‚’ echo ã™ã‚‹
$ npm run -s hello:foo
FOO

# 1ç§’å¾Œã« "BAR" ã‚’ echo ã™ã‚‹
$ npm run -s hello:bar
BAR
```

## npm-run-all ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```shell
# npm-run-all ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
$ npm install --save-dev npm-run-all
```

## å®Ÿè¡Œ

```shell

# hello:foo ã¨ hello:bar ã‚’é †æ¬¡å®Ÿè¡Œã™ã‚‹ hello-s ã¨ hello:foo ã¨ hello:bar ã‚’ä¸¦åˆ—å®Ÿè¡Œã™ã‚‹ hello-p ã‚’ç™»éŒ²
$ vi package.json
{
  (çœç•¥)
  "devDependencies": {
    "npm-run-all": "^4.1.5"
  },
  "scripts": {
    "hello:foo": "sleep 1 && echo FOO",
    "hello:bar": "sleep 1 && echo BAR",
+   "hello-s": "run-s hello:foo hello:bar",
+   "hello-p": "run-p hello:foo hello:bar"
  },
  (çœç•¥)
}

# FOO ãŒ echo ã•ã‚Œã¦ 1ç§’å¾Œã« BAR ãŒ echo ã•ã‚Œã‚‹ï¼ˆé †æ¬¡å®Ÿè¡Œï¼‰
$ npm run -s hello-s
FOO
BAR

# FOO ã¨ BAR ãŒã»ã¼åŒæ™‚ã« echo ã•ã‚Œã‚‹ï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰
$ npm run -s hello-p
BAR
FOO
```

# ãƒãƒã£ãŸã“ã¨

## npm-run-all ã¯ scripts ã«ç™»éŒ²ã—ãŸã“ã¨ã—ã‹å®Ÿè¡Œã§ããªã„

ãªã®ã§ã“ã†ã„ã†ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

```json:package.json
{
  (çœç•¥)
  "scripts": {
    "hoge": "npm-run-all -s 'sleep 1'"
  },
  (çœç•¥)
}
```

ä»¥ä¸‹ã®ã‚ˆã†ã«æ€’ã‚‰ã‚Œã¾ã™ã€‚

```
$ npm run hoge

> vpass_api_spec_document@1.0.0 hoge /Users/sugurutakahashi/git/vpass_api_spec_document
> npm-run-all -s 'sleep 1'

ERROR: Task not found: "sleep"
npm ERR! code ELIFECYCLE
npm ERR! errno 1
npm ERR! vpass_api_spec_document@1.0.0 hoge: `npm-run-all -s 'sleep 1'`
npm ERR! Exit status 1
npm ERR! 
npm ERR! Failed at the vpass_api_spec_document@1.0.0 hoge script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/sugurutakahashi/.npm/_logs/2020-11-03T16_29_57_468Z-debug.log
```
ã“ã‚Œã¯ sleep ã‚³ãƒãƒ³ãƒ‰ãŒ npm ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã§ã¯ãªã„ã‹ã‚‰ã€ã¨ã„ã†ã‚ã‘ã§ã‚‚ãªãã€scripts ã«ãªã„ã‚³ãƒãƒ³ãƒ‰ã¯å®Ÿè¡Œã§ããªã„ã¿ãŸã„ã§ã™ã€‚

ã‚ãã¾ã§ã‚‚ npm-run-all ã¯ scripts ã®å®Ÿè¡Œé †ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«å°‚ç”¨ã¨ã„ã†ã“ã¨ã§ã—ã‚‡ã†ã­ã€‚

scripts ã«ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã§ä¸€æ°—ã«ç™»éŒ²ã™ã‚‹ã‚ˆã‚Šã€ç´°ã‹ã scripts ã«ã‚³ãƒãƒ³ãƒ‰ã‚’ç™»éŒ²ã—ã¦ã€ãã‚Œã‚’ npm-run-all ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹ã¨ã„ã†ä½¿ã„æ–¹ãŒé©åˆ‡ãªã‚ˆã†ã§ã™ã€‚
