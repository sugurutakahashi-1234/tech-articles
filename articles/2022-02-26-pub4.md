---
title: "[Swift] [Combine] CurrentValueSubject ã«ã¤ã„ã¦ Calss ã¨ Struct ã§ã¯æŒ™å‹•ãŒç•°ãªã‚‹ä»¶"
emoji: "ğŸŒ¾"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Swift"]
published: true
---

# çµè«–

`CurrentValueSubject` ã® `Output` ã« `Struct` ã¾ãŸã¯ `Calss` ã‚’è¨­å®šã—ãŸå ´åˆã«ä»¥ä¸‹ã®ã‚ˆã†ãªå·®ãŒç”Ÿã˜ã‚‹ã€‚

- `Struct` ã®å ´åˆ
  - `var` ã¨ãªã‚‹å¤‰æ•°ã‚’æ›´æ–°ã—ãŸå ´åˆã€**å‡ºåŠ›ãŒèµ°ã‚‹**
- `Class` ã®å ´åˆ
  - `var` ã¨ãªã‚‹å¤‰æ•°ã‚’æ›´æ–°ã—ãŸå ´åˆã€**å‡ºåŠ›ã¯èµ°ã‚‰ãªã„**

# Struct ã®å ´åˆ

```swift
// ğŸŒŸstructğŸŒŸ
struct Hoge {
    var mogemoge: Int
    
    init(mogemoge: Int) {
        self.mogemoge = mogemoge
    }
}

let hogePub: CurrentValueSubject<Hoge, Never> = .init(Hoge(mogemoge: 0))

hogePub
    .dropFirst()
    .sink { print("receive: \(String(describing: $0.mogemoge))") }
    .store(in: &cancellables)

hogePub.value = Hoge(mogemoge: 1)
hogePub.value.mogemoge = 2 // â† æ³¨ç›®ğŸŒŸ
hogePub.value = Hoge(mogemoge: 3)

// ï¼ˆå‡ºåŠ›ï¼‰
// receive: 1
// receive: 2 â† æ³¨ç›®ğŸŒŸ
// receive: 3
```

- `var` ã¨ãªã‚‹å¤‰æ•°ã‚’æ›´æ–°ã—ãŸå ´åˆã€**å‡ºåŠ›ãŒèµ°ã‚‹**

ã¡ãªã¿ã« `nil` ã‚’è¨±å®¹ã—ã¦ã„ã‚‹å ´åˆã¯ã€`.value` è‡ªä½“ãŒ `nil` ã§ã‚‚ã€å‡ºåŠ›ãŒãªãŒã‚Œã‚‹ã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

- [[Swift] [Combine] CurrentValueSubject ã§ Struct å‹ã‹ã¤ nil ã‚’è¨±å®¹ã—ãŸã¨ãã®æ³¨æ„ç‚¹](https://zenn.dev/ikuraikura/articles/2022-02-26-cvs)

# Class ã®å ´åˆ

```swift
// ğŸŒŸclassğŸŒŸ
class Hoge {
    var mogemoge: Int
    
    init(mogemoge: Int) {
        self.mogemoge = mogemoge
    }
}

let hogePub: CurrentValueSubject<Hoge, Never> = .init(Hoge(mogemoge: 0))

hogePub
    .dropFirst()
    .sink { print("receive: \(String(describing: $0.mogemoge))") }
    .store(in: &cancellables)

hogePub.value = Hoge(mogemoge: 1)
hogePub.value.mogemoge = 2 // â† æ³¨ç›®ğŸŒŸ
hogePub.value = Hoge(mogemoge: 3)

// ï¼ˆå‡ºåŠ›ï¼‰
// receive: 1
// receive: 3
â†‘
receive: 2 ãŒãªã„ï¼ï¼
```

- `var` ã¨ãªã‚‹å¤‰æ•°ã‚’æ›´æ–°ã—ãŸå ´åˆã€**å‡ºåŠ›ã¯èµ°ã‚‰ãªã„**

`Class` ã®å ´åˆã¯ç›£è¦–ã—ãŸã„å¤‰æ•°ã‚’ `@Published` ã‚’ã¤ã‘ã¦ã€ç›£è¦–ã—ã¦ã‚ã’ã‚Œã°ã‚ˆã„ã®ã§ã€ãã®è¾ºãŒ `Struct` ã¨ã®å·®åˆ¥åŒ–ã«ãªã‚Šãã†ã§ã™ã€‚

## è€ƒå¯Ÿ

ã“ã®ã‚ˆã†ãªæŒ™å‹•ã®å·®ã¯ã€`Class` ãŒå‚ç…§å‹ã§ã‚ã‚Šã€`Struct` ãŒå€¤å‹ã§ã‚ã‚‹ã“ã¨åŸå› ã§ã‚ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚

ã¾ãŸã€ä¼¼ãŸã‚ˆã†ãªè©±ã¨ã—ã¦ã€`didSet` ã®æŒ™å‹•ã‚‚ `Class` ã¨ `Struct` ã§å·®ãŒã‚ã‚Šã¾ã™ã€‚

- å‚è€ƒ
  - [å€¤å‹ã¨å‚ç…§å‹ - Swiftã®å§‹ã‚æ–¹](https://swift.codelly.dev/guide/%E6%A7%8B%E9%80%A0%E4%BD%93%E3%81%A8%E3%82%AF%E3%83%A9%E3%82%B9/%E5%80%A4%E5%9E%8B%E3%81%A8%E5%8F%82%E7%85%A7%E5%9E%8B.html)
  - [[Swift] Calss ã¨ Struct ã®å¤‰æ•°ã® didSet æŒ™å‹•ã®é•ã„ã«ã¤ã„ã¦](https://zenn.dev/ikuraikura/articles/2022-02-27-did-set)

ä»¥ä¸Šã«ãªã‚Šã¾ã™ã€‚